import{_ as C,r as o,m as b,p as T,q as V,a as l,b as s,d as h,g as _,v as I,f as F,i as M,F as N,e as P,t as m,s as S,o as n}from"./index-x6LvLTz9.js";const A={class:"view chat-view"},B={class:"chat-controls"},D={class:"auto-label"},L={key:0,class:"muted"},U={class:"meta"},E={class:"text"},H={key:0,class:"error"},O={__name:"ChatView",setup(j){const i=o([]),v=o("/api/chat/message"),r=o(""),c=o(!1),k=o(5e3);let u=null;const d=o(null);function w(t){try{return new Date(t).toLocaleString()}catch{return t}}async function g(){r.value="";try{const t=await fetch(v.value,{cache:"no-store"});if(!t.ok)throw new Error(`HTTP ${t.status}`);const e=await t.json();let a="";typeof e=="string"?a=e:e.message?a=e.message:e.data&&e.data.message?a=e.data.message:a=JSON.stringify(e),i.value.push({time:new Date().toISOString(),text:a}),await S(),d.value&&(d.value.scrollTop=d.value.scrollHeight)}catch(t){r.value="Failed to fetch: "+(t.message||t)}}function y(){i.value=[]}function p(){f(),u=setInterval(()=>g(),k.value)}function f(){u&&(clearInterval(u),u=null)}return b(c,t=>{t?p():f()}),T(()=>{c.value&&p()}),V(()=>{f()}),(t,e)=>(n(),l("div",A,[e[4]||(e[4]=s("h1",null,"Chat Log",-1)),s("section",B,[e[3]||(e[3]=s("label",{for:"endpoint"},"API endpoint",-1)),_(s("input",{id:"endpoint","onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),placeholder:"/api/chat/message"},null,512),[[I,v.value]]),s("button",{onClick:g},"Fetch message"),s("button",{onClick:y},"Clear"),s("label",D,[_(s("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=a=>c.value=a)},null,512),[[M,c.value]]),e[2]||(e[2]=F(" Auto-poll",-1))])]),s("section",{class:"chat-log",ref_key:"logArea",ref:d},[i.value.length===0?(n(),l("div",L,'No messages yet. Click "Fetch message" to load one.')):h("",!0),(n(!0),l(N,null,P(i.value,(a,x)=>(n(),l("div",{key:x,class:"chat-message"},[s("div",U,m(w(a.time)),1),s("div",E,m(a.text),1)]))),128))],512),r.value?(n(),l("section",H,m(r.value),1)):h("",!0)]))}},J=C(O,[["__scopeId","data-v-a77ad742"]]);export{J as default};
